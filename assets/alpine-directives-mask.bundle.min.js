function e(e){e.directive("mask",((r,u,a)=>{let{value:s,expression:o}=u,{effect:f,evaluateLater:c}=a,h=()=>o,d="";function g(e){let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=e.value,a=h(u);if(!a||"false"===a)return!1;if(!1===r&&d.length-e.value.length==1)return d=e.value;let s=()=>{d=e.value=function(e,t){if(""===e)return"";let i=l(t,e),r=n(t,i);return r}(u,a)};i?t(e,a,(()=>{s()})):s()}queueMicrotask((()=>{if(["function","dynamic"].includes(s)){let t=c(o);f((()=>{h=l=>{let n;return e.dontAutoEvaluateFunctions((()=>{t((e=>{n="function"==typeof e?e(l):e}),{scope:{$input:l,$money:i.bind({el:r})}})})),n},g(r,!1)}))}else g(r,!1);r._x_model&&r._x_model.set(r.value)})),r.addEventListener("input",(()=>g(r))),r.addEventListener("blur",(()=>g(r,!1))),r.addEventListener("remask",(()=>g(r,!1,!0)))})).before("model")}function t(e,t,i){let r=e.selectionStart,u=e.value;i();let a=n(t,l(t,u.slice(0,r))).length;e.setSelectionRange(a,a)}function l(e,t){let l=t,n="",i={9:/[0-9]/,a:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/},r="";for(let t=0;t<e.length;t++)if(["9","a","*"].includes(e[t]))r+=e[t];else for(let n=0;n<l.length;n++)if(l[n]===e[t]){l=l.slice(0,n)+l.slice(n+1);break}for(let e=0;e<r.length;e++){let t=!1;for(let u=0;u<l.length;u++)if(i[r[e]].test(l[u])){n+=l[u],l=l.slice(0,u)+l.slice(u+1),t=!0;break}if(!t)break}return n}function n(e,t){let l=Array.from(t),n="";for(let t=0;t<e.length;t++)if(["9","a","*"].includes(e[t])){if(0===l.length)break;n+=l.shift()}else n+=e[t];return n}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".",l=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;if("-"===e)return"-";if(/^\D+$/.test(e))return"9";null==l&&(l=","===t?".":",");let i=e.startsWith("-")?"-":"",r=e.replaceAll(new RegExp(`[^0-9\\${t}]`,"g"),""),u=Array.from({length:r.split(t)[0].length}).fill("9").join("");return u=`${i}${((e,t)=>{let l="",n=0;for(let i=e.length-1;i>=0;i--)e[i]!==t&&(3===n?(l=e[i]+t+l,n=0):l=e[i]+l,n++);return l})(u,l)}`,n>0&&e.includes(t)&&(u+=`${t}`+"9".repeat(n)),queueMicrotask((()=>{this.el.value.endsWith(t)||this.el.value[this.el.selectionStart-1]===t&&this.el.setSelectionRange(this.el.selectionStart-1,this.el.selectionStart-1)})),u}export{n as buildUp,e as default,i as formatMoney,t as restoreCursorPosition,l as stripDown};
